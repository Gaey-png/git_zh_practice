# NewColor - ComfyUI颜色调整节点

一个功能强大的ComfyUI自定义节点，用于对图像进行专业的颜色调整。

## 功能特性

### 输入端口
- **image** (必需): 输入图像
- **mask** (可选): 遮罩图像，仅调整遮罩范围内的颜色

### 输出端口
- **image**: 调整后的图像

### 颜色调整功能

#### 基本调整
1. **亮度 (Brightness)**: 0.0 - 2.0，默认1.0
   - 调整图像的整体亮度

2. **对比度 (Contrast)**: 0.0 - 2.0，默认1.0
   - 调整图像的对比度

3. **饱和度 (Saturation)**: 0.0 - 2.0，默认1.0
   - 调整图像的颜色饱和度

4. **色相 (Hue)**: -0.5 - 0.5，默认0.0
   - 调整图像的色相偏移

#### RGB颜色模块
5. **RGB红色 (RGB Red)**: -1.0 - 1.0，默认0.0
   - 调整红色通道的强度

6. **RGB绿色 (RGB Green)**: -1.0 - 1.0，默认0.0
   - 调整绿色通道的强度

7. **RGB蓝色 (RGB Blue)**: -1.0 - 1.0，默认0.0
   - 调整蓝色通道的强度

#### 高级调整
8. **曝光 (Exposure)**: -2.0 - 2.0，默认0.0
   - 调整图像的曝光度（类似相机曝光）

9. **Gamma**: 0.1 - 3.0，默认1.0
   - 调整图像的Gamma值，影响中间调

10. **自然饱和度 (Vibrance)**: -1.0 - 1.0，默认0.0
    - 调整自然饱和度，主要影响低饱和度区域

11. **阴影 (Shadows)**: -1.0 - 1.0，默认0.0
    - 调整图像阴影区域的亮度

12. **高光 (Highlights)**: -1.0 - 1.0，默认0.0
    - 调整图像高光区域的亮度

## 安装方法

1. 将此文件夹放置到ComfyUI的`custom_nodes`目录中
2. 安装依赖：
```bash
pip install -r requirements.txt
```
3. 重启ComfyUI

## 使用方法

1. 在ComfyUI中添加`NewColor`节点
2. 连接输入图像到`image`端口
3. （可选）连接遮罩图像到`mask`端口，仅在遮罩范围内应用调整
4. 调整各种颜色参数
5. 连接输出图像到后续节点

### 遮罩使用说明
- 当提供遮罩时，颜色调整仅在遮罩的白色/高值区域生效
- 遮罩的黑色/低值区域保持原始图像不变
- 遮罩会自动调整大小以匹配输入图像

## 技术说明

- 使用PIL/Pillow进行图像处理
- 支持HSV颜色空间转换
- 遮罩混合使用alpha混合算法
- 所有参数都经过适当的裁剪和归一化处理

## 参数范围说明

- 小于1.0的值会减弱效果（例如亮度0.5会使图像变暗）
- 等于1.0的值保持原样
- 大于1.0的值会增强效果（例如亮度1.5会使图像变亮）
- RGB调整值0.0表示不变，正值增强，负值减弱

## 版本信息

- 版本: 1.0.0
- 兼容ComfyUI: 最新版本
- Python: 3.7+

